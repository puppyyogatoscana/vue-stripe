(function(u,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],a):(u=typeof globalThis<"u"?globalThis:u||self,a(u["vue-stripe"]={},u.Vue))})(this,function(u,a){"use strict";var S="https://js.stripe.com/v3",L=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,y="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",O=function(){for(var e=document.querySelectorAll('script[src^="'.concat(S,'"]')),n=0;n<e.length;n++){var i=e[n];if(L.test(i.src))return i}return null},h=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",i=document.createElement("script");i.src="".concat(S).concat(n);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(i),i},T=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.3.0",startTime:n})},f=null,m=null,v=null,A=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},I=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},D=function(e){return f!==null?f:(f=new Promise(function(n,i){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(y),window.Stripe){n(window.Stripe);return}try{var r=O();if(r&&e)console.warn(y);else if(!r)r=h(e);else if(r&&v!==null&&m!==null){var o;r.removeEventListener("load",v),r.removeEventListener("error",m),(o=r.parentNode)===null||o===void 0||o.removeChild(r),r=h(e)}v=I(n,i),m=A(i),r.addEventListener("load",v),r.addEventListener("error",m)}catch(d){i(d);return}}),f.catch(function(n){return f=null,Promise.reject(n)}))},R=function(e,n,i){if(e===null)return null;var r=e.apply(void 0,n);return T(r,i),r},p,_=!1,g=function(){return p||(p=D(null).catch(function(e){return p=null,Promise.reject(e)}),p)};Promise.resolve().then(function(){return g()}).catch(function(t){_||console.warn(t)});var E=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];_=!0;var r=Date.now();return g().then(function(o){return R(o,n,r)})};const P={name:"vue-stripe",version:{name:"vue-stripe-demi",version:"5.0.0",type:"module",files:["dist"],main:"./dist/vue-stripe.umd.js",module:"./dist/vue-stripe.es.js",exports:{".":{import:"./dist/vue-stripe.es.js",require:"./dist/vue-stripe.umd.js"}},scripts:{dev:"vite",build:"vite build",preview:"vite preview","test:unit":"vitest",lint:"eslint . --ext .vue,.js,.jsx,.cjs,.mjs --fix --ignore-path .gitignore","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:preview":"vitepress preview docs"},dependencies:{"@stripe/stripe-js":"^2.3.0","vue-demi":"^0.14.6"},devDependencies:{"@rushstack/eslint-patch":"^1.3.3","@vitejs/plugin-vue":"^4.5.2","@vue/test-utils":"^2.4.3",eslint:"^8.49.0","eslint-plugin-vue":"^9.17.0",jsdom:"^23.0.1",postcss:"^8.4.33",vite:"^5.0.10",vitepress:"^1.0.0-rc.39",vitest:"^1.0.4",vue:"^3.3.11"},peerDependencies:{"@vue/composition-api":"^1.7.2",vue:"^2.0.0 || >=3.0.0"},peerDependenciesMeta:{"@vue/composition-api":{optional:!0}},license:"MIT"}.version,url:"https://vuestripe.com",partner_id:"pp_partner_IqtOXpBSuz0IE2"},V="payment",$="linkAuthentication",x=a.defineComponent({name:"VueStripe",props:{pk:{type:String,default:"Vue Stripe Test"},options:{type:Object,default:()=>({})}},setup(t,{slots:e,emit:n,expose:i}){const r=a.reactive({stripe:null});a.onMounted(()=>{o(t.pk,t.options)});async function o(d,s){s!=null&&s.disableAdvancedFraudDetection&&E.setLoadParameters({advancedFraudSignals:!1});const c={stripeAccount:s==null?void 0:s.stripeAccount,apiVersion:s==null?void 0:s.apiVersion,locale:s==null?void 0:s.locale};r.stripe=await E(d,c),r.stripe.registerAppInfo(P)}return()=>{if(e.default)return e.default(r)}}}),k=a.defineComponent({name:"Elements",props:{stripe:{type:Object},clientSecret:{type:String},options:{type:Object,default:()=>({})}},setup(t,{slots:e,emit:n,expose:i}){const r=a.reactive({elements:null});a.watch(t,()=>{o(t.stripe,t.clientSecret,t.options)},{immediate:!1});async function o(d,s,c){r.elements=d.elements({...c,clientSecret:s})}return()=>{if(e.default)return e.default(r)}}});function j(t){const e=a.ref(null);a.ref(!1);async function n(l,b,Y){b&&(e.value=b.create(l,Y),e.value.on("change",r),e.value.on("ready",o),e.value.on("focus",d),e.value.on("blur",s),e.value.on("escape",c))}function i(l){e.value&&e.value.mount(l)}function r(l){t("change",l)}function o(l){t("ready",l)}function d(l){t("focus",l)}function s(l){t("blur",l)}function c(l){t("escape",l)}return{element:e,createElement:n,mountElement:i,handleElementChange:r,handleElementReady:o,handleElementFocus:d,handleElementBlur:s,handleElementEscape:c}}const w=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},M=a.defineComponent({name:"PaymentIntent",props:{stripe:{type:Object},elements:{type:Object},options:{type:Object,default:()=>({})},confirmParams:{type:Object,default:()=>({})}},setup(t,{emit:e,expose:n}){n({submit:s});const i=a.ref(null),{createElement:r,mountElement:o}=j(e);a.watch(t,()=>{d()});function d(){try{e("loading",!0),r(V,t.elements,t.options),o(i.value)}catch(c){console.error(c),e("error",error)}finally{e("loading",!1)}}async function s(){try{e("loading",!0);const{error:c}=t.stripe.confirmPayment({elements:t.elements,confirmParams:t.confirmParams});c&&(console.error(c),e("error",c))}catch(c){e("error",c)}finally{e("loading",!1)}}return{mountPoint:i}}}),C={ref:"mountPoint"};function N(t,e,n,i,r,o){return a.openBlock(),a.createElementBlock("div",C,null,512)}const B=w(M,[["render",N]]),F=a.defineComponent({name:"LinkAuthentication",props:{stripe:{type:Object},elements:{type:Object},options:{type:Object,default:()=>({})},confirmParams:{type:Object,default:()=>({})}},setup(t,{emit:e,expose:n}){n({submit:s});const i=a.ref(null),{createElement:r,mountElement:o}=j(e);a.watch(t,()=>{d()});function d(){try{e("loading",!0),r($,t.elements,t.options),o(i.value)}catch(c){console.error(c),e("error",error)}finally{e("loading",!1)}}async function s(){try{e("loading",!0);const{error:c}=t.stripe.confirmPayment({elements:t.elements,confirmParams:t.confirmParams});c&&(console.error(c),e("error",c))}catch(c){e("error",c)}finally{e("loading",!1)}}return{mountPoint:i}}}),q={ref:"mountPoint"};function U(t,e,n,i,r,o){return a.openBlock(),a.createElementBlock("div",q,null,512)}const W=w(F,[["render",U]]);var z={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function G(){console.log("useStripe"),console.log(z);async function t(e,n){n!=null&&n.disableAdvancedFraudDetection&&E.setLoadParameters({advancedFraudSignals:!1});const i={stripeAccount:n==null?void 0:n.stripeAccount,apiVersion:n==null?void 0:n.apiVersion,locale:n==null?void 0:n.locale},r=await E(e,i);return r.registerAppInfo(P),r}return{initializeStripe:t}}function X(){async function t(e,n,i){return e.elements({...i,clientSecret:n})}return{initializeElements:t}}u.Elements=k,u.LinkAuthentication=W,u.PaymentIntent=B,u.VueStripe=x,u.useElements=X,u.useStripe=G,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
